# ğŸ“± NOTIFICACIONES POR TELEGRAM - GuÃ­a Completa

## ğŸ¯ Sistema de Notificaciones Implementado

Has aÃ±adido un **sistema profesional de notificaciones** vÃ­a Telegram que te mantiene informado sobre todas tus tareas en tiempo real.

---

## âœ¨ Tipos de Notificaciones

### **1ï¸âƒ£ Tarea Completada** ğŸ‰
```
CuÃ¡ndo: Al marcar una tarea como completada
Mensaje:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‰ Â¡Tarea Completada! ğŸ‰    â”‚
â”‚                             â”‚
â”‚ ğŸ”´ Proyecto Python          â”‚
â”‚                             â”‚
â”‚ âœ… Estado: Completada        â”‚
â”‚ ğŸ“Š Prioridad: Alta          â”‚
â”‚ ğŸ… Pomodoros: 8             â”‚
â”‚                             â”‚
â”‚ â° 24/10/2024 15:30         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **2ï¸âƒ£ Tareas para MaÃ±ana** â°
```
CuÃ¡ndo: Al iniciar la app (si hay tareas para maÃ±ana)
Mensaje:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â° Recordatorio: Tareas      â”‚
â”‚    para MaÃ±ana              â”‚
â”‚                             â”‚
â”‚ ğŸ“… Tienes 3 tareas que      â”‚
â”‚    vencen maÃ±ana:           â”‚
â”‚                             â”‚
â”‚ 1. ğŸ”´ ReuniÃ³n cliente       â”‚
â”‚ 2. ğŸŸ¡ Revisar cÃ³digo        â”‚
â”‚ 3. ğŸŸ¢ Comprar materiales    â”‚
â”‚                             â”‚
â”‚ ğŸ’¡ Â¡Planifica tu dÃ­a!       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **3ï¸âƒ£ Tareas de Hoy** ğŸš¨
```
CuÃ¡ndo: Al iniciar la app (si hay tareas para hoy)
Mensaje:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸš¨ Â¡TAREAS PARA HOY! ğŸš¨     â”‚
â”‚                             â”‚
â”‚ ğŸ“… Tienes 2 tareas que      â”‚
â”‚    vencen HOY:              â”‚
â”‚                             â”‚
â”‚ 1. ğŸ”´ Entregar proyecto     â”‚
â”‚ 2. ğŸŸ¡ Llamar proveedor      â”‚
â”‚                             â”‚
â”‚ âš¡ Â¡A trabajar!              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **4ï¸âƒ£ Tareas Vencidas** âš ï¸
```
CuÃ¡ndo: Al iniciar la app (si hay tareas vencidas)
Mensaje:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ TAREAS VENCIDAS âš ï¸        â”‚
â”‚                             â”‚
â”‚ ğŸ“› Tienes 2 tareas que ya   â”‚
â”‚    vencieron:               â”‚
â”‚                             â”‚
â”‚ 1. ğŸ”´ Pagar facturas        â”‚
â”‚    Vencida hace 3 dÃ­as      â”‚
â”‚                             â”‚
â”‚ 2. ğŸŸ¡ Renovar licencia      â”‚
â”‚    Vencida hace 1 dÃ­a       â”‚
â”‚                             â”‚
â”‚ ğŸ”¥ Â¡AtenciÃ³n urgente!       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ConfiguraciÃ³n

### **Datos Pre-configurados:**
```
Bot Token: 8242520153:AAFAGHC88YFen6KnU6F6IioFWJyADgWz3Q8
Username Bot: @glitchbane_task_bot
Chat ID: 6009496370
Usuario: @glitchbane
Nombre: Isra
```

### **ConfiguraciÃ³n AutomÃ¡tica:**
Al ejecutar la aplicaciÃ³n por primera vez, se crea automÃ¡ticamente el archivo `telegram_config.json`:

```json
{
    "bot_token": "8242520153:AAFAGHC88YFen6KnU6F6IioFWJyADgWz3Q8",
    "chat_id": "6009496370",
    "username": "@glitchbane",
    "first_name": "Isra",
    "enabled": true,
    "notifications": {
        "task_completed": true,
        "task_tomorrow": true,
        "task_today": true,
        "task_overdue": true
    }
}
```

---

## ğŸ® Uso del Sistema

### **OpciÃ³n 13: Configurar Telegram**

```
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ âš™ï¸  CONFIGURACIÃ“N DE TELEGRAMâ”‚
â”‚                              â”‚
â”‚ Configura las notificaciones â”‚
â”‚ de tu gestor de tareas       â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

ConfiguraciÃ³n actual:
Bot Token: 8242520153:AAFAGH...
Chat ID: 6009496370
Usuario: @glitchbane
Estado: Habilitado

Opciones:
1. Probar conexiÃ³n
2. Habilitar/Deshabilitar notificaciones
3. Configurar tipos de notificaciones
4. Enviar mensaje de prueba
5. Verificar tareas y enviar notificaciones ahora
0. Volver

Seleccione una opciÃ³n:
```

### **OpciÃ³n 1: Probar ConexiÃ³n**
```
Probando conexiÃ³n...
âœ… ConexiÃ³n exitosa con @glitchbane_task_bot
```

### **OpciÃ³n 2: Habilitar/Deshabilitar**
```
âœ… Notificaciones habilitadas
   o
âš ï¸  Notificaciones deshabilitadas
```

### **OpciÃ³n 3: Configurar Tipos**
```
Â¿Notificar al completar tarea? (Y/n): y
Â¿Notificar tareas que vencen maÃ±ana? (Y/n): y
Â¿Notificar tareas que vencen hoy? (Y/n): y
Â¿Notificar tareas vencidas? (Y/n): y

âœ… ConfiguraciÃ³n guardada
```

### **OpciÃ³n 4: Mensaje de Prueba**
```
Enviando mensaje de prueba...
âœ… Mensaje enviado correctamente
Revisa tu Telegram
```

### **OpciÃ³n 5: Verificar Ahora**
```
Verificando tareas...
âœ… Notificaciones enviadas
Revisa tu Telegram
```

---

## ğŸ”„ Flujo AutomÃ¡tico

### **Al Iniciar la AplicaciÃ³n:**
```
1. python main.py
   â†“
2. Carga tareas desde tasks.json
   â†“
3. Verifica fechas lÃ­mite
   â†“
4. Si hay tareas vencidas â†’ NotificaciÃ³n âš ï¸
   â†“
5. Si hay tareas para hoy â†’ NotificaciÃ³n ğŸš¨
   â†“
6. Si hay tareas para maÃ±ana â†’ NotificaciÃ³n â°
   â†“
7. Muestra menÃº principal
```

### **Al Completar una Tarea:**
```
1. OpciÃ³n 2 â†’ Completar tarea
   â†“
2. Seleccionar tarea
   â†“
3. Marcar como completada
   â†“
4. Enviar notificaciÃ³n ğŸ‰
   â†“
5. Mostrar mensaje confirmaciÃ³n
   â†“
6. "ğŸ“± NotificaciÃ³n enviada a Telegram"
```

---

## ğŸ§  ImplementaciÃ³n TÃ©cnica

### **1. MÃ³dulo telegram_bot.py**

```python
import requests
import json

# Enviar mensaje bÃ¡sico
def send_telegram_message(message, parse_mode="HTML"):
    config = load_telegram_config()
    
    if not config.get("enabled", True):
        return False
    
    bot_token = config["bot_token"]
    chat_id = config["chat_id"]
    
    url = f"https://api.telegram.org/bot{bot_token}/sendMessage"
    
    payload = {
        "chat_id": chat_id,
        "text": message,
        "parse_mode": parse_mode
    }
    
    response = requests.post(url, json=payload, timeout=5)
    return response.status_code == 200
```

**Â¿QuÃ© hace?**
1. Carga configuraciÃ³n desde JSON
2. Verifica si estÃ¡ habilitado
3. Construye URL de API de Telegram
4. EnvÃ­a POST con mensaje
5. Retorna True si exitoso

### **2. NotificaciÃ³n de Tarea Completada**

```python
def notify_task_completed(task, pomodoros=0):
    config = load_telegram_config()
    
    # Verificar si este tipo estÃ¡ habilitado
    if not config["notifications"]["task_completed"]:
        return False
    
    description = task.get("description", "Sin descripciÃ³n")
    priority = task.get("priority", "media")
    
    # Emoji segÃºn prioridad
    priority_emoji = {
        "alta": "ğŸ”´",
        "media": "ğŸŸ¡",
        "baja": "ğŸŸ¢"
    }
    emoji = priority_emoji.get(priority, "âšª")
    
    # Construir mensaje con HTML
    message = f"""
ğŸ‰ <b>Â¡Tarea Completada!</b> ğŸ‰

{emoji} <b>{description}</b>

âœ… Estado: <i>Completada</i>
ğŸ“Š Prioridad: {priority.title()}
"""
    
    if pomodoros > 0:
        message += f"ğŸ… Pomodoros: {pomodoros}\n"
    
    message += f"\nâ° {datetime.now().strftime('%d/%m/%Y %H:%M')}"
    
    return send_telegram_message(message)
```

**Tags HTML soportados:**
- `<b>texto</b>` - Negrita
- `<i>texto</i>` - Cursiva
- `<code>texto</code>` - CÃ³digo
- `<pre>texto</pre>` - Preformateado

### **3. VerificaciÃ³n Diaria de Tareas**

```python
def check_and_send_daily_notifications(tasks):
    from datetime import date, timedelta
    
    today = date.today()
    tomorrow = today + timedelta(days=1)
    
    tasks_tomorrow = []
    tasks_today = []
    tasks_overdue = []
    
    for task in tasks:
        # Solo tareas NO completadas
        if task.get("completed", False):
            continue
        
        deadline_str = task.get("deadline")
        if not deadline_str:
            continue
        
        try:
            deadline_date = datetime.strptime(deadline_str, "%d/%m/%Y").date()
            
            # Clasificar por fecha
            if deadline_date == tomorrow:
                tasks_tomorrow.append(task)
            elif deadline_date == today:
                tasks_today.append(task)
            elif deadline_date < today:
                tasks_overdue.append(task)
        except:
            continue
    
    # Enviar notificaciones (prioridad: vencidas > hoy > maÃ±ana)
    if tasks_overdue:
        notify_tasks_overdue(tasks_overdue)
    
    if tasks_today:
        notify_tasks_today(tasks_today)
    
    if tasks_tomorrow:
        notify_tasks_tomorrow(tasks_tomorrow)
```

**Orden de prioridad:**
1. **Vencidas** (mÃ¡s urgente)
2. **Hoy** (urgente)
3. **MaÃ±ana** (recordatorio)

### **4. IntegraciÃ³n en main.py**

```python
# Al iniciar
def main():
    tasks = load_tasks()
    
    # Verificar y notificar
    try:
        check_and_send_daily_notifications(tasks)
    except:
        pass  # Si falla, continuar
```

```python
# Al completar tarea (en task_manager.py)
tasks[original_index]["completed"] = True

# Notificar
try:
    from telegram_bot import notify_task_completed
    pomodoros = task_to_complete.get("pomodoros_completed", 0)
    notify_task_completed(task_to_complete, pomodoros)
except:
    pass
```

---

## ğŸ” Seguridad y Privacidad

### **Archivo telegram_config.json:**
```
âš ï¸  IMPORTANTE:
- Este archivo contiene tu Bot Token
- NO lo compartas pÃºblicamente
- NO lo subas a GitHub sin .gitignore
- GuÃ¡rdalo de forma segura
```

### **AÃ±adir a .gitignore:**
```bash
# Archivo .gitignore
telegram_config.json
*.json
```

### **Â¿CÃ³mo funciona el Bot Token?**
```
Bot Token = ContraseÃ±a del bot
Chat ID = Tu identificador Ãºnico

Bot Token + Chat ID = Permiso para enviar mensajes a TI
```

**Nadie mÃ¡s puede:**
- Ver tus mensajes
- Recibir tus notificaciones
- Acceder a tu informaciÃ³n

---

## ğŸ“Š API de Telegram Bot

### **Endpoints Utilizados:**

**1. Enviar Mensaje:**
```
POST https://api.telegram.org/bot{TOKEN}/sendMessage
Body: {
    "chat_id": "6009496370",
    "text": "Mensaje",
    "parse_mode": "HTML"
}
```

**2. Obtener Info del Bot:**
```
GET https://api.telegram.org/bot{TOKEN}/getMe
Response: {
    "ok": true,
    "result": {
        "username": "glitchbane_task_bot",
        "first_name": "TaskBot"
    }
}
```

### **Parse Modes:**

**HTML (usado):**
```html
<b>Negrita</b>
<i>Cursiva</i>
<code>CÃ³digo</code>
```

**Markdown:**
```markdown
*Negrita*
_Cursiva_
`CÃ³digo`
```

---

## ğŸ’¡ Conceptos TÃ©cnicos Aprendidos

### **1. Requests (HTTP en Python)**

```python
import requests

# GET request
response = requests.get("https://api.example.com/data")

# POST request
response = requests.post(
    "https://api.example.com/send",
    json={"key": "value"},
    timeout=5
)

# Verificar respuesta
if response.status_code == 200:
    data = response.json()
```

**Status Codes:**
- 200: OK (Ã©xito)
- 400: Bad Request (solicitud incorrecta)
- 401: Unauthorized (sin autorizaciÃ³n)
- 404: Not Found (no encontrado)
- 500: Server Error (error del servidor)

### **2. Try-Except para Robustez**

```python
# Sin try-except (frÃ¡gil)
def send_message(msg):
    response = requests.post(url, json=msg)
    return response.status_code == 200
# Si falla requests, programa crashea

# Con try-except (robusto)
def send_message(msg):
    try:
        response = requests.post(url, json=msg, timeout=5)
        return response.status_code == 200
    except requests.exceptions.Timeout:
        print("Timeout")
        return False
    except requests.exceptions.ConnectionError:
        print("Sin conexiÃ³n")
        return False
    except Exception as e:
        print(f"Error: {e}")
        return False
# Si falla, maneja el error gracefully
```

### **3. ConfiguraciÃ³n con JSON**

```python
# Guardar configuraciÃ³n
config = {
    "bot_token": "...",
    "enabled": True
}

with open("config.json", "w") as f:
    json.dump(config, f, indent=4)

# Cargar configuraciÃ³n
with open("config.json", "r") as f:
    config = json.load(f)
```

**Ventajas de JSON:**
- Legible por humanos
- FÃ¡cil de editar
- Compatible con todos los lenguajes
- Estructura flexible

### **4. Timedelta (Operaciones con Fechas)**

```python
from datetime import date, timedelta

today = date.today()
tomorrow = today + timedelta(days=1)
yesterday = today - timedelta(days=1)

# Comparaciones
if deadline_date == tomorrow:
    print("Vence maÃ±ana")
elif deadline_date < today:
    print("Vencida")
```

---

## ğŸ¯ Casos de Uso

### **Caso 1: Recordatorio Matutino**
```
SituaciÃ³n: 7:00 AM, abres la app

Sistema verifica:
- 3 tareas para hoy
- 2 tareas para maÃ±ana
- 1 tarea vencida

Recibes 3 notificaciones en Telegram:
1. âš ï¸  "Tareas vencidas" (mÃ¡s urgente)
2. ğŸš¨ "Tareas para hoy"
3. â° "Tareas para maÃ±ana"

Resultado: Empiezas el dÃ­a informado
```

### **Caso 2: Trabajo Remoto**
```
SituaciÃ³n: Trabajando desde casa

Completas tarea en la app
â†“
NotificaciÃ³n instantÃ¡nea en Telegram
â†“
Puedes verificar en el mÃ³vil sin abrir la app
â†“
SensaciÃ³n de logro inmediato
```

### **Caso 3: Equipo Colaborativo**
```
SituaciÃ³n: MÃºltiples personas usan la misma app

Cada persona tiene su:
- Bot propio
- Chat ID Ãºnico
- Notificaciones personales

Ventaja: Privacidad y personalizaciÃ³n
```

---

## ğŸš€ Testing

### **Test 1: ConexiÃ³n del Bot**
```bash
1. python main.py
2. OpciÃ³n 13 â†’ Configurar Telegram
3. OpciÃ³n 1 â†’ Probar conexiÃ³n
4. Verificar: "âœ… ConexiÃ³n exitosa con @glitchbane_task_bot"
```

### **Test 2: Mensaje de Prueba**
```bash
1. OpciÃ³n 13 â†’ Configurar Telegram
2. OpciÃ³n 4 â†’ Enviar mensaje de prueba
3. Abrir Telegram en el mÃ³vil
4. Verificar: Mensaje recibido del bot
```

### **Test 3: NotificaciÃ³n al Completar**
```bash
1. Crear una tarea
2. OpciÃ³n 2 â†’ Completar tarea
3. Seleccionar la tarea
4. Verificar en consola: "ğŸ“± NotificaciÃ³n enviada"
5. Verificar en Telegram: "ğŸ‰ Â¡Tarea Completada!"
```

### **Test 4: Notificaciones Diarias**
```bash
1. Crear tareas con fechas:
   - 1 para hoy
   - 1 para maÃ±ana
   - 1 vencida (ayer)
2. Cerrar y volver a abrir la app
3. Verificar: 3 notificaciones en Telegram
```

### **Test 5: Habilitar/Deshabilitar**
```bash
1. OpciÃ³n 13 â†’ OpciÃ³n 2 â†’ Deshabilitar
2. Completar una tarea
3. Verificar: NO llega notificaciÃ³n
4. OpciÃ³n 13 â†’ OpciÃ³n 2 â†’ Habilitar
5. Completar otra tarea
6. Verificar: SÃ llega notificaciÃ³n
```

---

## ğŸ‰ Resultado

Has implementado un **sistema completo de notificaciones** con:

1. âœ… **4 tipos de notificaciones** diferentes
2. âœ… **ConfiguraciÃ³n flexible** por tipo
3. âœ… **VerificaciÃ³n automÃ¡tica** al iniciar
4. âœ… **NotificaciÃ³n inmediata** al completar
5. âœ… **Interfaz de configuraciÃ³n** completa
6. âœ… **Manejo de errores** robusto
7. âœ… **Mensajes con formato** HTML
8. âœ… **PriorizaciÃ³n inteligente** de notificaciones

**Â¡Tu gestor de tareas ahora te mantiene informado en todo momento!** ğŸš€

---

## ğŸ“š PrÃ³ximas Mejoras Posibles

- Comandos en el bot (responder mensajes)
- Crear tareas desde Telegram
- Ver lista de tareas desde Telegram
- Notificaciones programadas (8 AM diario)
- EstadÃ­sticas semanales por Telegram
- IntegraciÃ³n con otros servicios (Slack, Discord)

Â¿CuÃ¡l te gustarÃ­a implementar? ğŸ˜Š